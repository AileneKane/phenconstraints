BB_Flodoy = fFLstartm - fLDstartm
Flo_Frudoy = fFLstartm - fRFRstartm #will get negative values
Flo_Frudoy
min(Flo_Frudoy)
max(Flo_Frudoy)
min(fFRstartm)
max(fFRstartm)
fspecies<-names(fLDstartm)
BB_Flodoy = fFLstartm - fLDstartm
#min(fFRstartm)
#max(fFRstartm)
## Added best fit line 10/24
fspecies<-names(fLDstartm)
BB_Flodoy = fFLstartm - fLDstartm
BB_Frudoy = fRFRstartm - fLDstartm
Flo_Frudoy = fRFRstartm - fFLstartm
BB_SSdoy = fSENstartm - fLDstartm
Flo_SSdoy = fSENstartm - fFLstartm
Fru_SSdoy = fSENstartm - fRFRstartm
LOstartm<-tapply(dat2$LOutStart_DOY,dat2$Species,mean, na.rm=T)
LOendm<-tapply(dat2$LOutEnd_DOY,dat2$Species,mean, na.rm=T)
fLOstartm<- LOstartm[names(fFLstartm)]
fLOendm<- LOendm[names(fFLstartm)]
BB_LOdoy = fLOstartm - fLDstartm
LO_FLdoy = fFLstartm - fLOstartm
LO_FRdoy = fRFRstartm - fLOstartm
LO_SSdoy = fSENstartm - fLOstartm
BB_Flodoy = fFLstartm - fLDstartm
BB_Frudoy = fRFRstartm - fLDstartm
Flo_Frudoy = fRFRstartm - fFLstartm
summary(lm(Flo_Frudoy~fLDstartm))
fspecies<-names(fLDstartm)
fspecies_num<-c(1:25)
quartz(height=7, width=9)#this sets the dimensions of the plotting window
#par(mfrow=c(5,5))#this sets the number of rows and columns for the plots - in this case 5 rows and 5 columns
par(mfcol=c(5,5),mai=c(.2,.6,.2,.005), omi=c(.8,.01,.2,.2))#same thing but adding some measurements for margins within individual plots (may) and outside margins for the whole window (omi)
summary(lm(fLDstartm~BB_LOdoy))
Created a new csv file grosingeason_doy2
#Addition 08/10/2017
# Ripe Fruit: Start = 5-24% or more Ripe Fruits, End >95% Ripe Fruits
rm(list=ls())
options(stringsAsFactors = FALSE)
# Set working directory:
if(length(grep("ailene", getwd()))>0) {setwd("~/git/phenconstraints")}
pheno=read.csv("data/Phenology2015_R.csv",header=T)
head(pheno)
colnames(pheno)#see what all the column names are
dim(pheno)#see how many rows and columns there are (118 rwos, 365 columns)
pheno.long = reshape(pheno, varying = list(names(pheno)[3:35], names(pheno)[36:68], names(pheno)[69:101], names(pheno)[102:134], names(pheno)[135:167],
names(pheno)[168:200], names(pheno)[201:233], names(pheno)[234:266], names(pheno)[267:299],
names(pheno)[300:332], names(pheno)[333:365]),direction = "long",
v.names = c("Date","BB_No","CC_Perc", "FExpL_No","FB_No","F_No","IncLS_Perc","LDrop_Perc","LOut_Perc",
"OFlows_Perc","RipeF_Perc"))
dim(pheno.long)
colnames(pheno.long)
## Leaf Development
unique(pheno.long$BB_No)
pheno.long$LeafDevStart=NA #create a new column
pheno.long[which(pheno.long$BB_No == "<3"),]$LeafDevStart="N"
pheno.long[which(pheno.long$BB_No == "10-Mar"| pheno.long$BB_No == "11-100"| pheno.long$BB_No == "101-1000"|
pheno.long$BB_No == "1001-10000"| pheno.long$BB_No == ">10000"),]$LeafDevStart="Y"
unique(pheno.long$LeafDevStart)
unique(pheno.long$IncLS_Perc)
pheno.long$LeafDevEnd=NA #create a new column
pheno.long[which(pheno.long$IncLS_Perc == ">95"),]$LeafDevEnd="Y"
pheno.long[which(pheno.long$IncLS_Perc == "<5"| pheno.long$IncLS == "24-May"| pheno.long$IncLS_Perc == "<25"|
pheno.long$IncLS_Perc == "25-49"| pheno.long$IncLS_Perc == "25-94"| pheno.long$IncLS_Perc == "50-74"|
pheno.long$IncLS_Perc == "75-95"),]$LeafDevEnd="N"
unique(pheno.long$LeafDevEnd)
### Leaf Out Addition 10/23/16 for new phenology interphase graphs
unique(pheno.long$LOut_Perc)
pheno.long$LeafOutStart = NA
pheno.long[which(pheno.long$LOut_Perc == "<5"|pheno.long$LOut_Perc == "<25"),]$LeafOutStart="N"
pheno.long[which(pheno.long$LOut_Perc == "24-May"| pheno.long$LOut_Perc == "25-49"| pheno.long$LOut_Perc == "74-94%"|
pheno.long$LOut_Perc == "75-95"| pheno.long$LOut_Perc == "75-95%"| pheno.long$LOut_Perc == "50-74"|
pheno.long$LOut_Perc == ">95"| pheno.long$LOut_Perc == ">96"| pheno.long$LOut_Perc == ">97"),]$LeafOutStart="Y"
unique(pheno.long$LeafOutStart)
pheno.long$LeafOutEnd = NA
pheno.long[which(pheno.long$LOut_Perc == ">95"|pheno.long$LOut_Perc == ">96"|pheno.long$LOut_Perc == ">97"),]$LeafOutEnd="Y"
pheno.long[which(pheno.long$LOut_Perc == "<5"|pheno.long$LOut_Perc == "<25"|pheno.long$LOut_Perc == "24-May"| pheno.long$LOut_Perc == "25-49"|
pheno.long$LOut_Perc == "74-94%"| pheno.long$LOut_Perc == "75-95"| pheno.long$LOut_Perc == "75-95%"|
pheno.long$LOut_Perc == "50-74"),]$LeafOutEnd="N"
unique(pheno.long$LeafOutEnd)
## Flowering
unique(pheno.long$OFlows_Perc)
pheno.long$FloStart=NA #create a Start column
pheno.long[which(pheno.long$OFlows_Perc == "<5"),]$FloStart="N"
pheno.long[which(pheno.long$OFlows_Perc == "101-1000"| pheno.long$OFlows_Perc == "24-May"| pheno.long$OFlows_Perc == "25-49"|
pheno.long$OFlows_Perc == "50-74"|pheno.long$OFlows_Perc == "75-95"| pheno.long$OFlows_Perc == ">95" |
pheno.long$OFlows_Perc == "95"),]$FloStart="Y"
unique(pheno.long$FloStart)
pheno.long$FloEnd=NA #create a new column
pheno.long[which(pheno.long$OFlows_Perc == ">95" | pheno.long$OFlows_Perc == "95"),]$FloEnd="Y"
pheno.long[which(pheno.long$OFlows_Perc == "101-1000"| pheno.long$OFlows_Perc == "24-May"| pheno.long$OFlows_Perc == "25-49"|
pheno.long$OFlows_Perc == "50-74"|pheno.long$OFlows_Perc == "75-95"| pheno.long$OFlows_Perc == "<5"),]$FloEnd="N"
unique(pheno.long$FloEnd)
## Fruiting
unique(pheno.long$F_No)
pheno.long$FruitStart=NA
pheno.long[which(pheno.long$F_No == "<3"),]$FruitStart="N"
pheno.long[which(pheno.long$F_No == "10-Mar" | pheno.long$F_No == "1001-10000"| pheno.long$F_No == "101-1000"| pheno.long$F_No == "11-100"|
pheno.long$F_No == "1001-1000" | pheno.long$F_No == "101-10000" | pheno.long$F_No == ">10000"),]$FruitStart="Y"
unique(pheno.long$FruitStart)
unique(pheno.long$RipeF_Perc)
pheno.long$FruitEnd=NA
pheno.long[which(pheno.long$RipeF_Perc == ">95"),]$FruitEnd="Y"
pheno.long[which(pheno.long$RipeF_Perc == "<3"| pheno.long$RipeF_Perc == "<5"| pheno.long$RipeF_Perc == "24-May"| pheno.long$RipeF_Perc == "2-May"|
pheno.long$RipeF_Perc == "25-49"| pheno.long$RipeF_Perc == "50-74"| pheno.long$RipeF_Perc == "75-95"),]$FruitEnd="N"
unique(pheno.long$FruitEnd)
## Ripe Fruiting
unique(pheno.long$RipeF_Perc)
pheno.long$RipeFruitStart=NA
pheno.long[which(pheno.long$RipeF_Perc == "<3"| pheno.long$RipeF_Perc == "<5"),]$RipeFruitStart="N"
pheno.long[which(pheno.long$RipeF_Perc == "24-May"| pheno.long$RipeF_Perc == "2-May"| pheno.long$RipeF_Perc == "25-49"| pheno.long$RipeF_Perc == "50-74"|pheno.long$RipeF_Perc == "75-95"|pheno.long$RipeF_Perc == ">95"),]$RipeFruitStart="Y"
unique(pheno.long$RipeFruitStart)
pheno.long$RipeFruitEnd=NA
pheno.long[which(pheno.long$RipeF_Perc == ">95"),]$RipeFruitEnd="Y"
pheno.long[which(pheno.long$RipeF_Perc == "<3"| pheno.long$RipeF_Perc == "<5"| pheno.long$RipeF_Perc == "24-May"| pheno.long$RipeF_Perc == "2-May"|
pheno.long$RipeF_Perc == "25-49"| pheno.long$RipeF_Perc == "50-74"| pheno.long$RipeF_Perc == "75-95"),]$RipeFruitEnd="N"
unique(pheno.long$RipeFruitEnd)
## Senescence
unique(pheno.long$CC_Perc)
pheno.long$SenStart=NA
pheno.long[which(pheno.long$CC_Perc == "<5"),]$SenStart="N"
pheno.long[which(pheno.long$CC_Perc == "24-May"| pheno.long$CC_Perc == "25-49"| pheno.long$CC_Perc == "50-74"|
pheno.long$CC_Perc == "75-95"| pheno.long$CC_Perc == ">95"),]$SenStart="Y"
unique(pheno.long$SenStart)
pheno.long$SenEnd=NA
pheno.long[which(pheno.long$CC_Perc == ">95"),]$SenEnd="Y"
pheno.long[which(pheno.long$CC_Perc == "24-May"| pheno.long$CC_Perc == "25-49"| pheno.long$CC_Perc == "50-74"|
pheno.long$CC_Perc == "75-95"| pheno.long$CC_Perc == "<5"),]$SenEnd="N"
unique(pheno.long$SenEnd)
indivs<-unique(pheno.long$ACC_NUM)
ldevstart=c(rep(NA,times=length(indivs)))
ldevend=c(rep(NA,times=length(indivs)))
loutstart=c(rep(NA,times=length(indivs)))
loutend=c(rep(NA,times=length(indivs)))
flostart=c(rep(NA,times=length(indivs)))
floend=c(rep(NA,times=length(indivs)))
fruitstart=c(rep(NA,times=length(indivs)))
fruitend=c(rep(NA,times=length(indivs)))
ripefruitstart=c(rep(NA,times=length(indivs)))
ripefruitend=c(rep(NA,times=length(indivs)))
senstart=c(rep(NA,times=length(indivs)))
senend=c(rep(NA,times=length(indivs)))
species=c(rep(NA,times=length(indivs)))
for(i in 1:length(indivs)){
indivdat=pheno.long[pheno.long$ACC_NUM==indivs[i],]
ldevstart[i]=as.character(indivdat[which(indivdat$LeafDevStart=="Y"),]$Date[1])
ldevend[i]=as.character(indivdat[which(indivdat$LeafDevEnd=="Y"),]$Date[1])
loutstart[i]=as.character(indivdat[which(indivdat$LeafOutStart=="Y"),]$Date[1])
loutend[i]=as.character(indivdat[which(indivdat$LeafOutEnd=="Y"),]$Date[1])
flostart[i]=as.character(indivdat[which(indivdat$FloStart=="Y"),]$Date[1])
floend[i]=as.character(indivdat[which(indivdat$FloEnd=="Y"),]$Date[1])
fruitstart[i]=as.character(indivdat[which(indivdat$FruitStart=="Y"),]$Date[1])
fruitend[i]=as.character(indivdat[which(indivdat$FruitEnd=="Y"),]$Date[1])
ripefruitstart[i]=as.character(indivdat[which(indivdat$RipeFruitStart=="Y"),]$Date[1])
ripefruitend[i]=as.character(indivdat[which(indivdat$RipeFruitEnd=="Y"),]$Date[1])
senstart[i]=as.character(indivdat[which(indivdat$SenStart=="Y"),]$Date[1])
senend[i]=as.character(indivdat[which(indivdat$SenEnd=="Y"),]$Date[1])
species[i]=as.character(indivdat$Species[1])
}
alldata=cbind(as.character(indivs),species,ldevstart,ldevend,loutstart,loutend,flostart,floend,fruitstart,fruitend,ripefruitstart,ripefruitend,senstart,senend)
colnames(alldata)=c("Accession","Species","LDevStart","LDevEnd","LOutStart","LOutEnd","FloStart","FloEnd","FruitStart","FruitEnd","RipeFruitStart","RipeFruitEnd","SenStart","SenEnd")
head(alldata)
## Convert to DOY
LDStart_DOY=strptime(alldata[,3], "%m/%d/%Y")$yday+1
LDEnd_DOY=strptime(alldata[,4], "%m/%d/%Y")$yday+1
LOutStart_DOY=strptime(alldata[,5], "%m/%d/%Y")$yday+1
LOutEnd_DOY=strptime(alldata[,6], "%m/%d/%Y")$yday+1
FloStart_DOY=strptime(alldata[,7], "%m/%d/%Y")$yday+1
FloEnd_DOY=strptime(alldata[,8], "%m/%d/%Y")$yday+1
FruStart_DOY=strptime(alldata[,9], "%m/%d/%Y")$yday+1
FruEnd_DOY=strptime(alldata[,10], "%m/%d/%Y")$yday+1
RipeFruStart_DOY=strptime(alldata[,11], "%m/%d/%Y")$yday+1
RipeFruEnd_DOY=strptime(alldata[,12], "%m/%d/%Y")$yday+1
SenStart_DOY=strptime(alldata[,13], "%m/%d/%Y")$yday+1
SenEnd_DOY=strptime(alldata[,14], "%m/%d/%Y")$yday+1
alldata2=cbind(alldata,LDStart_DOY,LDEnd_DOY,LOutStart_DOY,LOutEnd_DOY,FloStart_DOY,FloEnd_DOY,FruStart_DOY,FruEnd_DOY,RipeFruStart_DOY,RipeFruEnd_DOY,SenStart_DOY,SenEnd_DOY)
head(alldata2)
write.csv(alldata2,"data/growingseason_doy2.csv")
alldata2<-as.data.frame(alldata2)
#Getting the numbers that sally had in her thesis (first paragraph in results)
min(as.numeric(alldata2$LDStart_DOY))#110
max(as.numeric(alldata2$LDStart_DOY))#142
min(as.numeric(alldata2$LOutStart_DOY))#117
max(as.numeric(alldata2$LOutStart_DOY))#147
min(as.numeric(alldata2$FloStart_DOY), na.rm=T)#111
max(as.numeric(alldata2$FloStart_DOY), na.rm=T)#252
min(as.numeric(alldata2$FruStart), na.rm=T)#132
max(as.numeric(alldata2$FruStart), na.rm=T)#315
min(as.numeric(alldata2$RipeFruStart), na.rm=T)#154
max(as.numeric(alldata2$RipeFruStart), na.rm=T)#329
min(as.numeric(alldata2$SenStart_DOY), na.rm=T)#245
max(as.numeric(alldata2$SenStart_DOY), na.rm=T)#301
rm(list=ls())
options(stringsAsFactors = FALSE)
# Set working directory:
if(length(grep("ailene", getwd()))>0) {setwd("~/git/phenconstraints")}
#Read in data:
dat<-read.csv("data/growingseason_doy.csv", header=T)
#dat2 has additional phenophases in it; otherwise i think the two datasets are the same?
#plot(dat$FruStart_DOY,dat2$FruStart_DOY)
#plot(dat$LDStart_DOY,dat2$LDStart_DOY)
dat2<-read.csv("data/growingseason_doy2.csv", header = T)
library(RColorBrewer)
#Assign colors, using the RcolorBrewer package- each species gets a different color
#Assign colors using ramping
#cols <- rev(colorRampPalette(brewer.pal(9,"YlOrRd"))(25))#red to yellow with later flowering dates
cols <- colorRampPalette(brewer.pal(9,"YlOrRd"))(25)#yellow to red with later flowering dates
dat2$SenEnd_DOY
LDstartm<-tapply(dat2$LDStart_DOY,dat2$Species,mean, na.rm=T)
LDendm<-tapply(dat2$LDEnd_DOY,dat2$Species,mean, na.rm=T)
LOstartm<-tapply(dat2$LOutStart_DOY,dat2$Species,mean, na.rm=T)
LOendm<-tapply(dat2$LOutEnd_DOY,dat2$Species,mean, na.rm=T)
FLstartm<-tapply(dat2$FloStart_DOY,dat2$Species,mean, na.rm=T)
FLendm<-tapply(dat2$FloEnd_DOY,dat2$Species,mean, na.rm=T)
FRstartm<-tapply(dat2$FruStart_DOY,dat2$Species,mean, na.rm=T)
FRendm<-tapply(dat2$FruEnd_DOY,dat2$Species,mean, na.rm=T)
SENstartm<-tapply(dat2$SenStart_DOY,dat2$Species,mean, na.rm=T)
SENendm<-tapply(dat2$SenEnd_DOY,dat2$Species,mean, na.rm=T)
RFRstartm<-tapply(dat2$RipeFruStart_DOY,dat2$Species,mean, na.rm=T)
RFRendm<-tapply(dat2$RipeFruEnd_DOY,dat2$Species,mean, na.rm=T)
### 8/8 sort values from earliest LD start date to latest
##sort by flowering time
fFLstartm<-sort(FLstartm, decreasing = FALSE)
fLDendm<-LDendm[names(fFLstartm)]
fLDstartm<-LDstartm[names(fFLstartm)]
fLOendm<-LOendm[names(fFLstartm)]
fLOstartm<-LOstartm[names(fFLstartm)]
fFLendm<-FLendm[names(fFLstartm)]
fFRstartm<-FRstartm[names(fFLstartm)]
fFRendm<-FRendm[names(fFLstartm)]
fRFRstartm<-RFRstartm[names(fFLstartm)]
fRFRendm<-RFRendm[names(fFLstartm)]
fSENstartm<-SENstartm[names(fFLstartm)]
fSENendm<-SENendm[names(fFLstartm)]
quartz(height=8,width=8)#for pc you replace "quartz" with X11
par(mai=c(1,3,.1,.1), omi=c(1.2,.1,.1,.2))
plot(10,10, type="p", cex=.8,pch=21, col="white", bty="L", xlab="Day of Year",ylab=" ", ylim=c(1,50), yaxt='n',xlim=c(110,340),las=1)
axis(side=2,at=c(seq(from =2, to = 50, by = 2)),labels=(paste(rev(names(fLDstartm)))),las=1)
#Start with first to flower
species<-names(fFLstartm)
### 7/24/16
y<-rev(seq(from =2, to = 50, by = 2))
for(i in 1:length(species)){
lines(c(fLOstartm[i],fSENendm[i]),c(y[i],y[i]), col="seagreen",lwd=3)
lines(c(fFLstartm[i],fFRendm[i]),c(y[i]-0.4,y[i]-0.4),col="lightgray", lwd=4)
lines(c(fFLstartm[i],fFRstartm[i]),c(y[i]-0.4,y[i]-0.4), col="orchid", lwd=3)
lines(c(fLDstartm[i],fLDendm[i]),c(y[i],y[i]), col="palegreen", lwd=3)
lines(c(fRFRstartm[i],fRFRendm[i]),c(y[i]-0.4,y[i]-0.4), col="darkorchid", lwd=3)
lines(c(fSENstartm[i],fSENendm[i]),c(y[i],y[i]), col="yellow2",lwd=3)
}
legend(330,50, legend=c("budburst","leafout", "senescence","in flower","fruit developing", "ripe fruit"), lty=1,lwd=2,col=c("seagreen","palegreen","yellow","orchid","gray","darkorchid"))
###########################################
# 10/5/16 & 10/18/16 plotting all possible combinations
# plotting the difference between flowering doy and leaf developement doy over the season
BB_Flodoy = fFLstartm - fLDstartm
#min(fFLstartm)
#max(fFLstartm)
#min(BB_Flodoy)
#max(BB_Flodoy)
#min(fLDstartm)
#max(fLDstartm)
Flo_Frudoy = fFLstartm - fRFRstartm #will get negative values
#min(Flo_Frudoy)
#max(Flo_Frudoy)
#min(fFRstartm)
#max(fFRstartm)
## Added best fit line 10/24
fspecies<-names(fLDstartm)
BB_Flodoy = fFLstartm - fLDstartm
BB_Frudoy = fRFRstartm - fLDstartm
Flo_Frudoy = fRFRstartm - fFLstartm
BB_SSdoy = fSENstartm - fLDstartm
Flo_SSdoy = fSENstartm - fFLstartm
Fru_SSdoy = fSENstartm - fRFRstartm
LOstartm<-tapply(dat2$LOutStart_DOY,dat2$Species,mean, na.rm=T)
LOendm<-tapply(dat2$LOutEnd_DOY,dat2$Species,mean, na.rm=T)
fLOstartm<- LOstartm[names(fFLstartm)]
fLOendm<- LOendm[names(fFLstartm)]
BB_LOdoy = fLOstartm - fLDstartm
LO_FLdoy = fFLstartm - fLOstartm
LO_FRdoy = fRFRstartm - fLOstartm
LO_SSdoy = fSENstartm - fLOstartm
BB_Flodoy = fFLstartm - fLDstartm
BB_Frudoy = fRFRstartm - fLDstartm
Flo_Frudoy = fRFRstartm - fFLstartm
BB_SSdoy = fSENstartm - fLDstartm
Flo_SSdoy = fSENstartm - fFLstartm
Fru_SSdoy = fSENstartm - fRFRstartm
BB_LOdoy = fLOstartm - fLDstartm
LO_FLdoy = fFLstartm - fLOstartm
LO_FRdoy = fRFRstartm - fLOstartm
LO_SSdoy = fSENstartm - fLOstartm
################################
################################
#### 11/1/16 Megaplot 2.0
####################
fspecies<-names(fFLstartm)
fspecies_num<-c(1:25)
quartz(height=7, width=9)#this sets the dimensions of the plotting window
#par(mfrow=c(5,5))#this sets the number of rows and columns for the plots - in this case 5 rows and 5 columns
par(mfcol=c(5,5),mai=c(.2,.6,.2,.005), omi=c(.8,.01,.2,.2))#same thing but adding some measurements for margins within individual plots (may) and outside margins for the whole window (omi)
#1-
plot(BB_LOdoy, fLDstartm, ylab = "", xlab = "Leaf Out - Budburst DOY",pch=21,bg=cols[fspecies_num], xaxt='n', bty="l", ylim=c(min(fLDstartm-5),max(fLDstartm+5)))
abline(lm(fLDstartm~BB_LOdoy))
mtext(paste("=",round(summary(lm(fLDstartm~BB_LOdoy))$r.squared, digits=2),",  p=",round(summary(lm(fLDstartm~BB_LOdoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext("Budburst DOY", side=2, cex=.7, line=2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.4) # works
plot(BB_LOdoy, fLOstartm, ylab = "", xlab = "",pch=21,bg=cols[fspecies_num], xaxt='n', bty="l", ylim=c(min(fLOstartm-5),max(fLOstartm+5)))
mtext(paste("=",round(summary((lm(fLOstartm~BB_LOdoy)))$r.squared, digits=2),", p=",round(summary(lm(fLOstartm~BB_LOdoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.35) # works
mtext("Leaf Out DOY", side=2, cex=.7, line=2)
plot(BB_LOdoy,fFLstartm, ylab = "", xlab = "",pch=21,bg=cols[fspecies_num], xaxt='n', bty="l", ylim=c(min(fFLstartm-5),max(fFLstartm+5)))
mtext("Flowering DOY", side=2, cex=.7, line=2)
mtext(paste("=",round(summary((lm(fFLstartm~BB_LOdoy)))$r.squared, digits=2),", p=",round(summary(lm(fFLstartm~BB_LOdoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext("Later phenological event", side=2, cex=.9, line=3, adj=.5)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.5) # works
plot(BB_LOdoy,fRFRstartm,  ylab = "", xlab = "",pch=21,bg=cols[fspecies_num], xaxt='n', bty="l", ylim=c(min(fRFRstartm-5),max(fRFRstartm+5)))
mtext("Fruiting DOY", side=2, cex=.7, line=2)
mtext(paste("=",round(summary((lm(fRFRstartm~BB_LOdoy)))$r.squared, digits=2),", p=",round(summary(lm(fRFRstartm~BB_LOdoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.4) # works
plot(BB_LOdoy,fSENstartm, ylab = "", xlab = "Leaf Out - Budburst DOY",pch=21,bg=cols[fspecies_num], bty="l", ylim=c(min(fSENstartm-5),max(fSENstartm+5)))
mtext("Leaf Out - Budburst DOY", side=1, cex=.7, line=2)
mtext("Senescence DOY", side=2, cex=.7, line=2)
mtext(paste("=",round(summary((lm(fSENstartm~BB_LOdoy)))$r.squared, digits=2),", p=",round(summary(lm(fSENstartm~BB_LOdoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.5) # works
#2
plot(BB_Flodoy, fLDstartm, xlab = "", ylab = "",pch=21,bg=cols[fspecies_num], xaxt='n', yaxt='n', bty="l", ylim=c(min(fLDstartm-5),max(fLDstartm+5)))
mtext(paste("=",round(summary((lm(fLDstartm~BB_Flodoy)))$r.squared, digits=2),", p=",round(summary(lm(fLDstartm~BB_Flodoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.5) # works
plot(BB_Flodoy,fLOstartm, ylab = "", xlab = "",pch=21,bg=cols[fspecies_num], xaxt='n', yaxt='n', bty="l", ylim=c(min(fLOstartm-5),max(fLOstartm+5)))
abline(lm(fLOstartm~BB_Flodoy), lty=2)
mtext(paste("=",round(summary((lm(fLOstartm~BB_Flodoy)))$r.squared, digits=2),", p=",round(summary(lm(fLOstartm~BB_Flodoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.35) # works
plot(BB_Flodoy,fFLstartm, ylab = "", xlab = "",pch=21,bg=cols[fspecies_num], xaxt='n', yaxt='n', bty="l", ylim=c(min(fFLstartm-5),max(fFLstartm+5)))
abline(lm(fFLstartm~BB_Flodoy))
mtext(paste("=",round(summary((lm(fFLstartm~BB_Flodoy)))$r.squared, digits=2),", p=",round(summary(lm(fFLstartm~BB_Flodoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.55) # works
plot(BB_Flodoy,fRFRstartm, ylab = "", xlab = "",pch=21,bg=cols[fspecies_num], xaxt='n', yaxt='n', bty="l", ylim=c(min(fRFRstartm-5),max(fRFRstartm+5)))
abline(lm(fRFRstartm~BB_Flodoy))
mtext(paste("=",round(summary((lm(fRFRstartm~BB_Flodoy)))$r.squared, digits=2),", p=",round(summary(lm(fRFRstartm~BB_Flodoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.35) # works
plot(BB_Flodoy,fSENstartm, ylab = "", xlab = "Flowering - Budburst DOY",pch=21,bg=cols[fspecies_num], yaxt='n', ylim=c(min(fSENstartm-5),max(fSENstartm+5)), bty="l")
mtext(paste("=",round(summary((lm(fSENstartm~BB_Flodoy)))$r.squared, digits=2),", p=",round(summary(lm(fSENstartm~BB_Flodoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.35) # works
mtext("Flowering - Budburst DOY", side=1, cex=.7, line=2)
plot(LO_FLdoy, fLDstartm, ylab = "", xlab = "",pch=21,bg=cols[fspecies_num], xaxt='n', yaxt='n', bty="l", ylim=c(min(fLDstartm-5),max(fLDstartm+5)))
#3
mtext(paste("=",round(summary((lm(fLDstartm~LO_FLdoy)))$r.squared, digits=2),", p=",round(summary(lm(fLDstartm~LO_FLdoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.35) # works
plot(LO_FLdoy, fLOstartm, ylab = "", xlab = "",pch=21,bg=cols[fspecies_num], xaxt='n', yaxt='n', bty="l", ylim=c(min(fLOstartm-5),max(fLOstartm+5)))
mtext(paste("=",round(summary((lm(fLOstartm~LO_FLdoy)))$r.squared, digits=2),", p=",round(summary(lm(fLOstartm~LO_FLdoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.35) # works
plot(LO_FLdoy, fFLstartm, ylab = "", xlab = "",pch=21,bg=cols[fspecies_num], xaxt='n', yaxt='n', bty="l", ylim=c(min(fFLstartm-5),max(fFLstartm+5)))
abline(lm(fFLstartm~LO_FLdoy))
mtext(paste("=",round(summary((lm(fFLstartm~LO_FLdoy)))$r.squared, digits=2),", p=",round(summary(lm(fFLstartm~LO_FLdoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.55) # works
plot(LO_FLdoy, fRFRstartm, ylab = "", xlab = "",pch=21,bg=cols[fspecies_num], xaxt='n', yaxt='n', bty="l", ylim=c(min(fRFRstartm-5),max(fRFRstartm+5)))
mtext(paste("=",round(summary((lm(fRFRstartm~LO_FLdoy)))$r.squared, digits=2),", p=",round(summary(lm(fRFRstartm~LO_FLdoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
abline(lm(fRFRstartm~LO_FLdoy))
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.55) # works
plot(LO_FLdoy,fSENstartm, ylab = "", xlab = "Flowering - Leaf Out DOY",pch=21,bg=cols[fspecies_num],yaxt='n', bty="l", ylim=c(min(fSENstartm-5),max(fSENstartm+5)))
mtext("Flowering - Leaf Out DOY", side=1, cex=.7, line=2)
mtext(paste("=",round(summary((lm(fSENstartm~LO_FLdoy)))$r.squared, digits=2),", p=",round(summary(lm(fSENstartm~LO_FLdoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext("Inter-phenophase time", side=1, cex=.9, line=3, adj=.5)
#4
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.35) # works
plot(Flo_Frudoy,fLDstartm,xlab = "", ylab = "",pch=21,bg=cols[fspecies_num], xaxt='n', yaxt='n', bty="l", ylim=c(min(fLDstartm-5),max(fLDstartm+5)))
mtext(paste("=",round(summary((lm(fLDstartm~Flo_Frudoy)))$r.squared, digits=2),", p=",round(summary(lm(fLDstartm~Flo_Frudoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.35) # works
plot(Flo_Frudoy, fLOstartm, ylab = "", xlab = "",pch=21,bg=cols[fspecies_num], xaxt='n', yaxt='n', bty="l", ylim=c(min(fLOstartm-5),max(fLOstartm+5)))
mtext(paste("=",round(summary((lm(fLOstartm~Flo_Frudoy)))$r.squared, digits=2),", p=",round(summary(lm(fLOstartm~Flo_Frudoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.5) # works
plot(Flo_Frudoy, fFLstartm, ylab = "", xlab = "",pch=21,bg=cols[fspecies_num], xaxt='n', yaxt='n', bty="l", ylim=c(min(fFLstartm-5),max(fFLstartm+5)))
mtext(paste("=",round(summary((lm(fFLstartm~Flo_Frudoy)))$r.squared, digits=2),", p=",round(summary(lm(fFLstartm~Flo_Frudoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.35) # works
plot(Flo_Frudoy, fRFRstartm, ylab = "", xlab = "",pch=21,bg=cols[fspecies_num], xaxt='n', yaxt='n', bty="l", ylim=c(min(fRFRstartm-5),max(fRFRstartm+5)))
abline(lm(fRFRstartm~Flo_Frudoy))
mtext(paste("=",round(summary((lm(fRFRstartm~Flo_Frudoy)))$r.squared, digits=2),", p=",round(summary(lm(fRFRstartm~Flo_Frudoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.6) # works
plot(Flo_Frudoy, fSENstartm, ylab = "", xlab = "Fruiting - Flowering DOY",pch=21,bg=cols[fspecies_num], yaxt='n', bty="l",ylim=c(min(fSENstartm-5),max(fSENstartm+5)))
mtext("Fruiting - Flowering DOY", side=1, cex=.7, line=2)
mtext(paste("=",round(summary((lm(fSENstartm~Flo_Frudoy)))$r.squared, digits=2),", p=",round(summary(lm(fSENstartm~Flo_Frudoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
abline(lm(fSENstartm~Flo_Frudoy), lty=2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.4) # works
#5
plot(Fru_SSdoy, fLDstartm, xlab = "", ylab = "",pch=21,bg=cols[fspecies_num], xaxt='n', yaxt='n', bty="l",ylim=c(min(fLDstartm-5),max(fLDstartm+5)))
abline(lm(fLDstartm~Fru_SSdoy))
mtext(paste("=",round(summary((lm(fLDstartm~Fru_SSdoy)))$r.squared, digits=2),", p=",round(summary(lm(fLDstartm~Fru_SSdoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.35) # works
plot(Fru_SSdoy, fLOstartm, xlab = "", ylab = "",pch=21,bg=cols[fspecies_num], xaxt='n', yaxt='n', bty="l", ylim=c(min(fLOstartm-5),max(fLOstartm+5)))
mtext(paste("=",round(summary(lm(fLOstartm~Fru_SSdoy))$r.squared, digits=2),", p=",round(summary(lm(fLOstartm~Fru_SSdoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.35) # works
abline(lm(fLOstartm~Fru_SSdoy), lty=2)
plot(Fru_SSdoy, fFLstartm, xlab = "", ylab = "",pch=21,bg=cols[fspecies_num], xaxt='n', yaxt='n', bty="l", ylim=c(min(fFLstartm-5),max(fFLstartm+5)))
abline(lm(fFLstartm~Fru_SSdoy))
mtext(paste("=",round(summary((lm(fFLstartm~Fru_SSdoy)))$r.squared, digits=2),", p=",round(summary(lm(fFLstartm~Fru_SSdoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.6) # works
plot(Fru_SSdoy, fRFRstartm, xlab = "", ylab = "",pch=21,bg=cols[fspecies_num], xaxt='n', yaxt='n', bty="l", ylim=c(min(fRFRstartm-5),max(fRFRstartm+5)))
abline(lm(fRFRstartm~Fru_SSdoy))
mtext(paste("=",round(summary((lm(fRFRstartm~Fru_SSdoy)))$r.squared, digits=2),", p=",round(summary(lm(fRFRstartm~Fru_SSdoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.6) # works
plot(Fru_SSdoy, fSENstartm, xlab = "", ylab = "Senescence - Fruiting DOY",pch=21,bg=cols[fspecies_num], yaxt='n', bty="l", ylim=c(min(fSENstartm-5),max(fSENstartm+5)))
mtext("Senescence - Fruiting DOY", side=1, cex=.7, line=2)
mtext(paste("=",round(summary((lm(fSENstartm~Fru_SSdoy)))$r.squared, digits=2),", p=",round(summary(lm(fSENstartm~Fru_SSdoy))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.55) # works
##Now plot of later stage versus earlier stage
fspecies<-names(fFLstartm)
fspecies_num<-c(1:25)
quartz(height=7, width=7)#this sets the dimensions of the plotting window
#par(mfrow=c(5,5))#this sets the number of rows and columns for the plots - in this case 5 rows and 5 columns
par(mfcol=c(4,4),mai=c(.2,.7,.2,.01), omi=c(.8,.01,.2,.2))#same thing but adding some measurements for margins within individual plots (may) and outside margins for the whole window (omi)
#1- commenting this panel out for now because budburst is earliest stage- can't predict it with previous stage
#plot(BB_LOdoy, fLDstartm, ylab = "Budburst DOY", xlab = "Leaf Out - Budburst DOY",bg=cols[as.numeric(as.factor(fspecies))])
#abline(lm(BB_LOdoy~fLDstartm))
plot(fLDstartm, fLOstartm, ylab = "Leaf Out", xlab = "",pch=21,bg=cols[fspecies_num], bty="l")
abline(lm(fLOstartm~fLDstartm))
mtext(paste("=",round(summary((lm(fLOstartm~fLDstartm)))$r.squared, digits=2),", p=",round(summary(lm(fLOstartm~fLDstartm))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.4) # works
plot(fLDstartm,fFLstartm, ylab = "Flowering DOY", xlab = "",pch=21,bg=cols[fspecies_num], bty="l")
abline(lm(fFLstartm~fLDstartm))
mtext(paste("=",round(summary((lm(fFLstartm~fLDstartm)))$r.squared, digits=2),", p=",round(summary(lm(fFLstartm~fLDstartm))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.2) # works
mtext("Later phenological event", side=2, cex=.9, line=4, adj=1)
plot(fLDstartm,fRFRstartm,  ylab = "Fruiting DOY", xlab = "",pch=21,bg=cols[fspecies_num], bty="l")
abline(lm(fRFRstartm~fLDstartm))
mtext(paste("=",round(summary((lm(fRFRstartm~fLDstartm)))$r.squared, digits=2),", p=",round(summary(lm(fRFRstartm~fLDstartm))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.2) # works
plot(fLDstartm,fSENstartm, ylab = "Senescence DOY", xlab = "",pch=21,bg=cols[fspecies_num], bty="l")
#abline(lm(fSENstartm~fLDstartm), lty=2)
mtext(paste("=",round(summary((lm(fSENstartm~fLDstartm)))$r.squared, digits=2),", p=",round(summary(lm(fSENstartm~fLDstartm))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.2) # works
mtext("Budburst DOY", side=1, cex=.7, line=2)
#2
plot.new()
plot(fLOstartm,fFLstartm, ylab = "", xlab = "",pch=21,bg=cols[fspecies_num], bty="l")
abline(lm(fFLstartm~fLOstartm))
mtext(paste("=",round(summary((lm(fFLstartm~fLOstartm)))$r.squared, digits=2),", p=",round(summary(lm(fFLstartm~fLOstartm))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.3) # works
plot(fLOstartm,fRFRstartm, ylab = "", xlab = "",pch=21,bg=cols[fspecies_num], bty="l")
abline(lm(fRFRstartm~fLOstartm))
mtext(paste("=",round(summary((lm(fRFRstartm~fLOstartm)))$r.squared, digits=2),", p=",round(summary(lm(fRFRstartm~fLOstartm))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.2) # works
plot(fLOstartm,fSENstartm, ylab = "", xlab = " ",pch=21,bg=cols[fspecies_num], bty="l")
mtext("Leafout DOY", side=1, cex=.7, line=2)
mtext(paste("=",round(summary((lm(fSENstartm~fLOstartm)))$r.squared, digits=2),", p=",round(summary(lm(fSENstartm~fLOstartm))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.2) # works
mtext("Previous phenological event", side=1, cex=.9, line=3, adj=0)
#3
plot.new()
plot.new()
plot(fFLstartm, fRFRstartm, ylab = "", xlab = "",pch=21,bg=cols, bty="l")
abline(lm(fRFRstartm~fFLstartm))
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.4) # works
mtext(paste("=",round(summary((lm(fRFRstartm~fFLstartm)))$r.squared, digits=2),", p=",round(summary(lm(fRFRstartm~fFLstartm))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
plot(fFLstartm,fSENstartm, ylab = "", xlab = "",pch=21,bg=cols[fspecies_num], bty="l")
mtext("Flowering DOY", side=1, cex=.7, line=2)
mtext(paste("=",round(summary((lm(fSENstartm~fFLstartm)))$r.squared, digits=2),", p=",round(summary(lm(fSENstartm~fFLstartm))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.2) # works
#4
par(xpd=NA)
plot(c(seq(1:25)),c(seq(1:25)), col="white",ylab = "", xlab = "",bty="n",xaxt='n', yaxt='n')
legend(-2,26,legend=fspecies,pch=21,pt.bg=cols[fspecies_num], bty="n")
#plot(c(seq(1:25)),c(seq(1:25)), col="white",ylab = "", xlab = "",bty="n",xaxt='n', yaxt='n')
#legend(-1,26,legend=fspecies[9:16],pch=21,pt.bg=cols[as.numeric(as.factor(fspecies))][9:16], bty="n")
#plot(c(seq(1:25)),c(seq(1:25)), col="white",ylab = "", xlab = "",bty="n",xaxt='n', yaxt='n')
#legend(-1,26,legend=fspecies[17:25],pch=21,pt.bg=cols[as.numeric(as.factor(fspecies))][17:25], bty="n")
#plot.new()
plot.new()
plot.new()
#for(i in 1:length(fspecies)){
#  mtext(paste(fspecies[i]),side=3, line=23-i, cex=.6, adj=0)
#}
par(xpd=FALSE)
plot(fRFRstartm,fSENstartm, ylab = "", xlab = "",pch=21,bg=cols[fspecies_num], bty="l")
abline(lm(fSENstartm~fRFRstartm), lty=2)
mtext(expression( "r" ^ italic("2")), side=3, line=-.5, cex=.6, adj=.3) # works
mtext(paste("=",round(summary((lm(fSENstartm~fRFRstartm)))$r.squared, digits=2),", p=",round(summary(lm(fSENstartm~fRFRstartm))$coeff[2,4],digits=3)), side=3, line=-.5, cex=.6, adj=1.2)
mtext("Fruiting DOY", side=1, cex=.7, line=2)
summary((lm(fSENstartm~fRFRstartm))
)
summary((lm(fSENstartm~fFLstartm))
)
summary((lm(fRFRstartm~fFLstartm))
)
summary((lm(fRFRstartm~fLOstartm))
)
summary((lm(fRFRstartm~fLDstartm)))
summary((lm(fSENstartm~Fru_SSdoy)))
summary((lm(fRFRstartm~Fru_SSdoy)))
summary((lm(fFLstartm~Fru_SSdoy)))
summary(lm(fLOstartm~Fru_SSdoy))
summary((lm(fLDstartm~Fru_SSdoy)))
summary(lm(fLDstartm~BB_LOdoy))
summary(lm(fLOstartm~Fru_SSdoy))
summary((lm(fSENstartm~Flo_Frudoy)))
summary((lm(fRFRstartm~Flo_Frudoy))
)
summary((lm(fSENstartm~Fru_SSdoy)))
summary((lm(fRFRstartm~Fru_SSdoy)))
lm(fRFRstartm~Flo_Frudoy)))
summary((lm(fRFRstartm~LO_FLdoy)))
summary((lm(fRFRstartm~BB_Flodoy)))
Fru_SSdoy
which(Fru_SSdoy>0)
which(Fru_SSdoy<0)
length(Fru_SSdoy)
9/25
length(which(Fru_SSdoy>0))
hist(fLOstartm)
