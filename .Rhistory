#inter-phenophase times:
BB_LOdoy = fLOstartm - fLDstartm
LO_FLdoy = fFLstartm - fLOstartm
Flo_Frudoy = fRFRstartm - fFLstartm
Fru_SSdoy = fSENstartm - fRFRstartm
#Fit the previous stage models
LO_BBmod<-lm(fLOstartm~fLDstartm)
FL_BBmod<-lm(fFLstartm~fLDstartm)
FR_BBmod<-lm(fFRstartm~fLDstartm)
SEN_BBmod<-lm(fSENstartm~fLDstartm)
FL_LOmod<-lm(fFLstartm~fLOstartm)
FR_LOmod<-lm(fFRstartm~fLOstartm)
SEN_LOmod<-lm(fSENstartm~fLOstartm)
FR_FLmod<-lm(fFRstartm~fFLstartm)
SEN_FLmod<-lm(fSENstartm~fFLstartm)
SEN_FRmod<-lm(fSENstartm~fFRstartm)
#Previous stage model tables:
prevmodtable<-rbind(c(round(summary(LO_BBmod)$coeff[1,1:2],digits=3),round(summary(LO_BBmod)$r.squared,digits=3), round(summary(LO_BBmod)$coeff[2,4],digits=3)),c(round(summary(FL_BBmod)$coeff[1,1:2],digits=3),round(summary(FL_BBmod)$r.squared,digits=3), round(summary(FL_BBmod)$coeff[2,4],digits=3)),c(round(summary(FR_BBmod)$coeff[1,1:2],digits=3),round(summary(FR_BBmod)$r.squared,digits=3), round(summary(FR_BBmod)$coeff[2,4],digits=3)),c(round(summary(SEN_BBmod)$coeff[1,1:2],digits=3),round(summary(SEN_BBmod)$r.squared,digits=3), round(summary(SEN_BBmod)$coeff[2,4],digits=3)),c(round(summary(FL_LOmod)$coeff[1,1:2],digits=3),round(summary(FL_LOmod)$r.squared,digits=3), round(summary(FL_LOmod)$coeff[2,4],digits=3)),c(round(summary(FR_LOmod)$coeff[1,1:2],digits=3),round(summary(FR_LOmod)$r.squared,digits=3), round(summary(FR_LOmod)$coeff[2,4],digits=3)),c(round(summary(SEN_LOmod)$coeff[1,1:2],digits=3),round(summary(SEN_LOmod)$r.squared,digits=3), round(summary(SEN_LOmod)$coeff[2,4],digits=3)),c(round(summary(FR_FLmod)$coeff[1,1:2],digits=3),round(summary(FR_FLmod)$r.squared,digits=3), round(summary(FR_FLmod)$coeff[2,4],digits=3)),c(round(summary(SEN_FLmod)$coeff[1,1:2],digits=3),round(summary(SEN_FLmod)$r.squared,digits=3), round(summary(SEN_FLmod)$coeff[2,4],digits=3)),c(round(summary(SEN_FRmod)$coeff[1,1:2],digits=3),round(summary(SEN_FRmod)$r.squared,digits=3), round(summary(SEN_FRmod)$coeff[2,4],digits=3)))
prevmodtable
prevmodtable<-cbind(c("leafout vs. budburst","flowering vs. budburst","fruiting vs. budburst","senescence vs. budburst","flowering vs. leafout","fruiting vs. leafout","senescence vs. leafout","fruiting vs. flowering","senescence vs. flowering","senesence vs. fruiting"),prevmodtable)
colnames(prevmodtable)<-c("previous phenostage model","intercept","slope","r2","P")
prevmodtable
prevmodtable<-rbind(c(round(summary(LO_BBmod)$coeff[1,1:2],digits=3),round(summary(LO_BBmod)$r.squared,digits=3), round(summary(LO_BBmod)$coeff[2,4],digits=3)),c(round(summary(FL_BBmod)$coeff[1,1:2],digits=3),round(summary(FL_BBmod)$r.squared,digits=3), round(summary(FL_BBmod)$coeff[2,4],digits=3)),c(round(summary(FR_BBmod)$coeff[1,1:2],digits=3),round(summary(FR_BBmod)$r.squared,digits=3), round(summary(FR_BBmod)$coeff[2,4],digits=3)),c(round(summary(SEN_BBmod)$coeff[1,1:2],digits=3),round(summary(SEN_BBmod)$r.squared,digits=3), round(summary(SEN_BBmod)$coeff[2,4],digits=3)),c(round(summary(FL_LOmod)$coeff[1,1:2],digits=3),round(summary(FL_LOmod)$r.squared,digits=3), round(summary(FL_LOmod)$coeff[2,4],digits=3)),c(round(summary(FR_LOmod)$coeff[1,1:2],digits=3),round(summary(FR_LOmod)$r.squared,digits=3), round(summary(FR_LOmod)$coeff[2,4],digits=3)),c(round(summary(SEN_LOmod)$coeff[1,1:2],digits=3),round(summary(SEN_LOmod)$r.squared,digits=3), round(summary(SEN_LOmod)$coeff[2,4],digits=3)),c(round(summary(FR_FLmod)$coeff[1,1:2],digits=3),round(summary(FR_FLmod)$r.squared,digits=3), round(summary(FR_FLmod)$coeff[2,4],digits=3)),c(round(summary(SEN_FLmod)$coeff[1,1:2],digits=3),round(summary(SEN_FLmod)$r.squared,digits=3), round(summary(SEN_FLmod)$coeff[2,4],digits=3)),c(round(summary(SEN_FRmod)$coeff[1,1:2],digits=3),round(summary(SEN_FRmod)$r.squared,digits=3), round(summary(SEN_FRmod)$coeff[2,4],digits=3)))
prevmodtable<-cbind(c("leafout vs. budburst","flowering vs. budburst","fruiting vs. budburst","senescence vs. budburst","flowering vs. leafout","fruiting vs. leafout","senescence vs. leafout","fruiting vs. flowering","senescence vs. flowering","senesence vs. fruiting"),prevmodtable)
colnames(prevmodtable)<-c("previous phenostage model","intercept","slope","r2","P")
prevmodtable<-rbind(c(round(summary(LO_BBmod)$coeff[1,1:2],digits=3),round(summary(LO_BBmod)$r.squared,digits=3), round(summary(LO_BBmod)$coeff[2,4],digits=3)),c(round(summary(FL_BBmod)$coeff[1,1:2],digits=3),round(summary(FL_BBmod)$r.squared,digits=3), round(summary(FL_BBmod)$coeff[2,4],digits=3)),c(round(summary(FR_BBmod)$coeff[1,1:2],digits=3),round(summary(FR_BBmod)$r.squared,digits=3), round(summary(FR_BBmod)$coeff[2,4],digits=3)),c(round(summary(SEN_BBmod)$coeff[1,1:2],digits=3),round(summary(SEN_BBmod)$r.squared,digits=3), round(summary(SEN_BBmod)$coeff[2,4],digits=3)),c(round(summary(FL_LOmod)$coeff[1,1:2],digits=3),round(summary(FL_LOmod)$r.squared,digits=3), round(summary(FL_LOmod)$coeff[2,4],digits=3)),c(round(summary(FR_LOmod)$coeff[1,1:2],digits=3),round(summary(FR_LOmod)$r.squared,digits=3), round(summary(FR_LOmod)$coeff[2,4],digits=3)),c(round(summary(SEN_LOmod)$coeff[1,1:2],digits=3),round(summary(SEN_LOmod)$r.squared,digits=3), round(summary(SEN_LOmod)$coeff[2,4],digits=3)),c(round(summary(FR_FLmod)$coeff[1,1:2],digits=3),round(summary(FR_FLmod)$r.squared,digits=3), round(summary(FR_FLmod)$coeff[2,4],digits=3)),c(round(summary(SEN_FLmod)$coeff[1,1:2],digits=3),round(summary(SEN_FLmod)$r.squared,digits=3), round(summary(SEN_FLmod)$coeff[2,4],digits=3)),c(round(summary(SEN_FRmod)$coeff[1,1:2],digits=3),round(summary(SEN_FRmod)$r.squared,digits=3), round(summary(SEN_FRmod)$coeff[2,4],digits=3)))
colnames(prevmodtable)<-c("previous phenostage model","intercept","slope","r2","P")
colnames(prevmodtable)<-c("intercept","slope","r2","P")
prevmodtable
prevmod$p[yeartable$p<0.001]<-"<0.001"
prevmodtable$p[prevmodtable$p<0.001]<-"<0.001"
prevmodtable$p
prevmodtable
prevmodtable<-data.frame(rbind(c(round(summary(LO_BBmod)$coeff[1,1:2],digits=3),round(summary(LO_BBmod)$r.squared,digits=3), round(summary(LO_BBmod)$coeff[2,4],digits=3)),c(round(summary(FL_BBmod)$coeff[1,1:2],digits=3),round(summary(FL_BBmod)$r.squared,digits=3), round(summary(FL_BBmod)$coeff[2,4],digits=3)),c(round(summary(FR_BBmod)$coeff[1,1:2],digits=3),round(summary(FR_BBmod)$r.squared,digits=3), round(summary(FR_BBmod)$coeff[2,4],digits=3)),c(round(summary(SEN_BBmod)$coeff[1,1:2],digits=3),round(summary(SEN_BBmod)$r.squared,digits=3), round(summary(SEN_BBmod)$coeff[2,4],digits=3)),c(round(summary(FL_LOmod)$coeff[1,1:2],digits=3),round(summary(FL_LOmod)$r.squared,digits=3), round(summary(FL_LOmod)$coeff[2,4],digits=3)),c(round(summary(FR_LOmod)$coeff[1,1:2],digits=3),round(summary(FR_LOmod)$r.squared,digits=3), round(summary(FR_LOmod)$coeff[2,4],digits=3)),c(round(summary(SEN_LOmod)$coeff[1,1:2],digits=3),round(summary(SEN_LOmod)$r.squared,digits=3), round(summary(SEN_LOmod)$coeff[2,4],digits=3)),c(round(summary(FR_FLmod)$coeff[1,1:2],digits=3),round(summary(FR_FLmod)$r.squared,digits=3), round(summary(FR_FLmod)$coeff[2,4],digits=3)),c(round(summary(SEN_FLmod)$coeff[1,1:2],digits=3),round(summary(SEN_FLmod)$r.squared,digits=3), round(summary(SEN_FLmod)$coeff[2,4],digits=3)),c(round(summary(SEN_FRmod)$coeff[1,1:2],digits=3),round(summary(SEN_FRmod)$r.squared,digits=3), round(summary(SEN_FRmod)$coeff[2,4],digits=3))))
colnames(prevmodtable)<-c("intercept","slope","r2","P")
prevmodtable$p[prevmodtable$p<0.001]<-"<0.001"
prevmodtable$p
prevmodtable$P[prevmodtable$P<0.001]<-"<0.001"
prevmodtable
prevmodtable<-cbind(c("leafout vs. budburst","flowering vs. budburst","fruiting vs. budburst","senescence vs. budburst","flowering vs. leafout","fruiting vs. leafout","senescence vs. leafout","fruiting vs. flowering","senescence vs. flowering","senesence vs. fruiting"),prevmodtable)
colnames(prevmodtable)[1]<-("previous phenostage model")
prevmodtable
FLstartm
names(fFLstartm)
inddat<-dat2[order(names(fFLstartm)),]
inddat
names(fFLstartm)
reorder.factor(df$Species, new.order=names(fFLstartm))
require(gdata)
install.packages("data")
install.packages("gdata")
require(gdata)
df$Species2 <- reorder.factor(df$Species, new.order=names(fFLstartm))
df$Species
inddat$Species2 <- reorder.factor(inddat$Species, new.order=names(fFLstartm))
reorder.factor(inddat$Species, new.order=names(fFLstartm))
names(fFLstartm)
inddat
inddat<-dat2[order(dat2$FloStart),]
inddat
inddat$Species
names(fFLstartm)
nameorder<-cbind(names(fFLstartm),c(1:25))
nameorder
dat3<-left_join(dat2,nameorderby=c("Species"), copy=TRUE)
dat3<-left_join(dat2,nameorder,by=c("Species"), copy=TRUE)
nameorder<-cbind(names(fFLstartm),c(1:25))
nameorder
colnames(nameorder)<-c("Species","Order")
dat3<-left_join(dat2,nameorder,by=c("Species"), copy=TRUE)
nameorder
nameorder<-data.frame(cbind(names(fFLstartm),c(1:25)))
colnames(nameorder)<-c("Species","Order")
dat3<-left_join(dat2,nameorder,by=c("Species"), copy=TRUE)
dat3
###Analyses and figures for Sally's Phenology data
#occur during the growing season at Arnold ARboretum, for Sally Gee's thesis data
#by Ailene and sally
#June 2017
## housekeeping
rm(list=ls())
options(stringsAsFactors = FALSE)
# Set working directory:
if(length(grep("ailene", getwd()))>0) {setwd("~/git/phenconstraints")}
#Read in data:
#dat<-read.csv("data/growingseason_doy.csv", header=T)
#dat2 has additional phenophases in it; otherwise i think the two datasets are the same?
#plot(dat$FruStart_DOY,dat2$FruStart_DOY)
#plot(dat$LDStart_DOY,dat2$LDStart_DOY)
dat2<-read.csv("data/growingseason_doy2.csv", header = T)
#ailene added ripe fruit to dat2 on august 10, 2017
#dim(dat2)
#head(dat)
#names(dat)
#names(dat2)
library(RColorBrewer)
#Assign colors, using the RcolorBrewer package- each species gets a different color
#Assign colors using ramping
#cols <- rev(colorRampPalette(brewer.pal(9,"YlOrRd"))(25))#red to yellow with later flowering dates
cols <- colorRampPalette(brewer.pal(9,"YlOrRd"))(25)#yellow to red with later flowering dates
#dat2$SenEnd_DOY
##data are currently by individual, but we want to plot them by species.
## convert this to a summary by species (with mean start and end date across species for each phase)
LDstartm<-tapply(dat2$LDStart_DOY,dat2$Species,mean, na.rm=T)
LDendm<-tapply(dat2$LDEnd_DOY,dat2$Species,mean, na.rm=T)
LOstartm<-tapply(dat2$LOutStart_DOY,dat2$Species,mean, na.rm=T)
LOendm<-tapply(dat2$LOutEnd_DOY,dat2$Species,mean, na.rm=T)
FLstartm<-tapply(dat2$FloStart_DOY,dat2$Species,mean, na.rm=T)
FLendm<-tapply(dat2$FloEnd_DOY,dat2$Species,mean, na.rm=T)
FRstartm<-tapply(dat2$FruStart_DOY,dat2$Species,mean, na.rm=T)
FRendm<-tapply(dat2$FruEnd_DOY,dat2$Species,mean, na.rm=T)
SENstartm<-tapply(dat2$SenStart_DOY,dat2$Species,mean, na.rm=T)
SENendm<-tapply(dat2$SenEnd_DOY,dat2$Species,mean, na.rm=T)
RFRstartm<-tapply(dat2$RipeFruStart_DOY,dat2$Species,mean, na.rm=T)
RFRendm<-tapply(dat2$RipeFruEnd_DOY,dat2$Species,mean, na.rm=T)
##sort by flowering time
fFLstartm<-sort(FLstartm, decreasing = FALSE)
fLDendm<-LDendm[names(fFLstartm)]
fLDstartm<-LDstartm[names(fFLstartm)]
fLOendm<-LOendm[names(fFLstartm)]
fLOstartm<-LOstartm[names(fFLstartm)]
fFLendm<-FLendm[names(fFLstartm)]
fFRstartm<-FRstartm[names(fFLstartm)]
fFRendm<-FRendm[names(fFLstartm)]
fRFRstartm<-RFRstartm[names(fFLstartm)]
fRFRendm<-RFRendm[names(fFLstartm)]
fSENstartm<-SENstartm[names(fFLstartm)]
fSENendm<-SENendm[names(fFLstartm)]
##Now Plot
#figure out what max and min values are for all phases, so that i know what the x axis limits should be
#max(dat[,12:19],na.rm=T)
#min(dat[,12:19],na.rm=T)
quartz(height=8,width=10)#for pc you replace "quartz" with X11
par(mai=c(1,3,.1,.1), omi=c(1.2,.1,.1,.2))
plot(8,10, type="p", cex=.8,pch=21, col="white", bty="L", xlab="Day of Year",ylab=" ", ylim=c(1,50), yaxt='n',xlim=c(110,385),las=1)
axis(side=2,at=c(seq(from =2, to = 50, by = 2)),labels=(paste(rev(names(fLDstartm)))),las=1, font=3)
#Start with first to flower
species<-names(fFLstartm)
### 7/24/16
y<-rev(seq(from =2, to = 50, by = 2))
for(i in 1:length(species)){
lines(c(fLOstartm[i],fSENendm[i]),c(y[i],y[i]), col="seagreen",lwd=3)
lines(c(fFLstartm[i],fFRendm[i]),c(y[i]-0.4,y[i]-0.4),col="lightgray", lwd=4)
lines(c(fFLstartm[i],fFRstartm[i]),c(y[i]-0.4,y[i]-0.4), col="orchid", lwd=3)
lines(c(fLDstartm[i],fLDendm[i]),c(y[i],y[i]), col="palegreen", lwd=3)
lines(c(fRFRstartm[i],fRFRendm[i]),c(y[i]-0.4,y[i]-0.4), col="darkorchid", lwd=3)
lines(c(fSENstartm[i],fSENendm[i]),c(y[i],y[i]), col="yellow2",lwd=3)
}
legend(325,50, legend=c("budburst","leafout", "senescence","in flower","fruit developing", "ripe fruit"), lty=1,lwd=2,col=c("palegreen","seagreen","yellow","orchid","gray","darkorchid"), cex=.85)
#Plot same figure, but for individual instead of species:
#sort by species-level mean flowering date
nameorder<-data.frame(cbind(names(fFLstartm),c(1:25)))
colnames(nameorder)<-c("Species","Order")
dat3<-left_join(dat2,nameorder,by=c("Species"), copy=TRUE)
inddat<-dat3[order(dat3$Order),]
quartz(height=12,width=12)#for pc you replace "quartz" with X11
par(mai=c(1,1.5,.1,.1), omi=c(1.5,.1,.1,.2))
plot(10,15, type="p", cex=.8,pch=21, col="white", bty="L", xlab="Day of Year",ylab=" ", ylim=c(2,236), yaxt='n',xlim=c(110,390),las=1)
inddat$Species
rev(inddat$Species)
names(fFLstartm)
quartz(height=12,width=12)#for pc you replace "quartz" with X11
par(mai=c(1,1.5,.1,.1), omi=c(1.5,.1,.1,.2))
plot(10,15, type="p", cex=.8,pch=21, col="white", bty="L", xlab="Day of Year",ylab=" ", ylim=c(2,236), yaxt='n',xlim=c(110,390),las=1)
#Make new label for y-axis that is has species name only once
axis(side=2,at=c(seq(from =2, to = 236, by = 10)),labels=(paste(rev(names(fFLstartm)))),las=1, cex.axis=0.3)
c(seq(from =2, to = 236, by = 10))
quartz(height=12,width=12)#for pc you replace "quartz" with X11
par(mai=c(1,1.5,.1,.1), omi=c(1.5,.1,.1,.2))
plot(10,15, type="p", cex=.8,pch=21, col="white", bty="L", xlab="Day of Year",ylab=" ", ylim=c(2,236), yaxt='n',xlim=c(110,390),las=1)
quartz(height=12,width=12)#for pc you replace "quartz" with X11
par(mai=c(1,1.5,.1,.1), omi=c(1.5,.1,.1,.2))
plot(10,15, type="p", cex=.8,pch=21, col="white", bty="L", xlab="Day of Year",ylab=" ", ylim=c(2,236), yaxt='n',xlim=c(110,390),las=1)
length(c(seq(from =2, to = 236, by = 10)))
c(seq(from =2, to = 236, by = 10))
length(rev(names(fFLstartm))))
length(rev(names(fFLstartm)))
y<-rev(seq(from =2, to = 236, by = 2))
quartz(height=12,width=12)#for pc you replace "quartz" with X11
par(mai=c(1,1.5,.1,.1), omi=c(1.5,.1,.1,.2))
plot(10,15, type="p", cex=.8,pch=21, col="white", bty="L", xlab="Day of Year",ylab=" ", ylim=c(2,236), yaxt='n',xlim=c(110,390),las=1)
y<-rev(seq(from =2, to = 236, by = 2))
for(i in 1:length(inddat$Species)){
lines(c(inddat$LOutStart_DOY[i],inddat$LOutEnd_DOY[i]),c(y[i],y[i]), col="seagreen",lwd=2)
lines(c(inddat$LDStart_DOY[i],inddat$SenEnd_DOY[i]),c(y[i],y[i]), col="seagreen",lwd=2)
lines(c(inddat$FloStart_DOY[i],inddat$RipeFruEnd_DOY[i]),c(y[i]-0.4,y[i]-0.4),col="lightgray", lwd=2)
lines(c(inddat$FloStart_DOY[i],inddat$FruStart_DOY[i]),c(y[i]-0.4,y[i]-0.4), col="orchid", lwd=2)
lines(c(inddat$LDStart_DOY[i],inddat$LDEnd_DOY[i]),c(y[i],y[i]), col="palegreen", lwd=2)
lines(c(inddat$RipeFruStart_DOY[i],inddat$RipeFruEnd_DOY[i]),c(y[i]-0.4,y[i]-0.4), col="darkorchid", lwd=2)
lines(c(inddat$SenStart_DOY[i],inddat$SenEnd_DOY[i]),c(y[i],y[i]), col="yellow2",lwd=2)
}
i
axis(side=2,at=c(seq(from =2, to = 242, by = 10)),labels=(paste(rev(names(fFLstartm)))),las=1, cex.axis=0.3)
inddat$Species
names<- c("Populus deltoides"," "," "," "," ",
"Quercus alba"," "," "," "," " ,
"Quercus glandulifera"," "," "," ",
"Carya ovata"," "," "," "," ",
"Fraxinus chinensis"," "," "," "," ",
"Liquidambar styraciflua"," "," "," "," ",
"Platanus occidentalis","","","","",
"Carya glabra",""," "," "," ",
"Crataegus crus-galli"," "," "," "," ",
"Phellodendron amurense"," ","  "," ",
"Liriodendron tulipifera"," "," "," "," ",
"Betula alleghaniensis"," "," "," "," ",
"Gleditsia triacanthos"," "," "," "," ",
"Tilia japonica"," "," "," "," ",
"Catalpa speciosa"," "," "," "," ",
"Tilia americana"," "," "," "," ",
"Kalopanax septemlobus"," "," ",
"Styphnolobium japonicum"," "," "," "," ",
"Betula nigra", " "," "," "," ",
"Pyrus ussuriensis"," "," "," "," ",
"Fagus engleriana"," "," "," ",
"Quercus rubra", " "," "," "," ",
"Aesculus flava"," "," "," "," ",
"Fagus grandifolia"," "," "," "," ",
"Pyrus calleryana var. dimorphophylla" " "," ")
names<- c("Populus deltoides"," "," "," "," ",
"Quercus alba"," "," "," "," " ,
"Quercus glandulifera"," "," "," ",
"Carya ovata"," "," "," "," ",
"Fraxinus chinensis"," "," "," "," ",
"Liquidambar styraciflua"," "," "," "," ",
"Platanus occidentalis","","","","",
"Carya glabra",""," "," "," ",
"Crataegus crus-galli"," "," "," "," ",
"Phellodendron amurense"," ","  "," ",
"Liriodendron tulipifera"," "," "," "," ",
"Betula alleghaniensis"," "," "," "," ",
"Gleditsia triacanthos"," "," "," "," ",
"Tilia japonica"," "," "," "," ",
"Catalpa speciosa"," "," "," "," ",
"Tilia americana"," "," "," "," ",
"Kalopanax septemlobus"," "," ",
"Styphnolobium japonicum"," "," "," "," ",
"Betula nigra", " "," "," "," ",
"Pyrus ussuriensis"," "," "," "," ",
"Fagus engleriana"," "," "," ",
"Quercus rubra", " "," "," "," ",
"Aesculus flava"," "," "," "," ",
"Fagus grandifolia"," "," "," "," ",
"Pyrus calleryana var. dimorphophylla"," "," ")
axis(side=2,at=c(seq(from =2, to = 242, by = 10)),labels=(paste(rev(names))),las=1, cex.axis=0.3)
names<- c("Populus deltoides"," "," "," "," ",
"Quercus alba"," "," "," "," " ,
"Quercus glandulifera"," "," "," ",
"Carya ovata"," "," "," "," ",
"Fraxinus chinensis"," "," "," "," ",
"Liquidambar styraciflua"," "," "," "," ",
"Platanus occidentalis","","","","",
"Carya glabra",""," "," "," ",
"Crataegus crus-galli"," "," "," "," ",
"Phellodendron amurense"," ","  "," ",
"Liriodendron tulipifera"," "," "," "," ",
"Betula alleghaniensis"," "," "," "," ",
"Gleditsia triacanthos"," "," "," "," ",
"Tilia japonica"," "," "," "," ",
"Catalpa speciosa"," "," "," "," ",
"Tilia americana"," "," "," "," ",
"Kalopanax septemlobus"," "," ",
"Styphnolobium japonicum"," "," "," "," ",
"Betula nigra", " "," "," "," ",
"Pyrus ussuriensis"," "," "," "," ",
"Fagus engleriana"," "," "," ",
"Quercus rubra", " "," "," "," ",
"Aesculus flava"," "," "," "," ",
"Fagus grandifolia"," "," "," "," ",
"Pyrus calleryana var. dimorphophylla"," "," ")
axis(side=2,at=c(seq(from =2, to = 236, by = 2)),labels=(paste(rev(names))),las=1, cex.axis=0.3)
#Plot same figure, but for individual instead of species:
#sort by species-level mean flowering date
nameorder<-data.frame(cbind(names(fFLstartm),c(1:25)))
colnames(nameorder)<-c("Species","Order")
dat3<-left_join(dat2,nameorder,by=c("Species"), copy=TRUE)
inddat<-dat3[order(dat3$Order),]
quartz(height=12,width=12)#for pc you replace "quartz" with X11
par(mai=c(1,1.5,.1,.1), omi=c(1.5,.1,.1,.2))
plot(10,15, type="p", cex=.8,pch=21, col="white", bty="L", xlab="Day of Year",ylab=" ", ylim=c(2,236), yaxt='n',xlim=c(110,390),las=1)
#Make new label for y-axis that is has species name only once
names<- c("Populus deltoides"," "," "," "," ",
"Quercus alba"," "," "," "," " ,
"Quercus glandulifera"," "," "," ",
"Carya ovata"," "," "," "," ",
"Fraxinus chinensis"," "," "," "," ",
"Liquidambar styraciflua"," "," "," "," ",
"Platanus occidentalis","","","","",
"Carya glabra",""," "," "," ",
"Crataegus crus-galli"," "," "," "," ",
"Phellodendron amurense"," ","  "," ",
"Liriodendron tulipifera"," "," "," "," ",
"Betula alleghaniensis"," "," "," "," ",
"Gleditsia triacanthos"," "," "," "," ",
"Tilia japonica"," "," "," "," ",
"Catalpa speciosa"," "," "," "," ",
"Tilia americana"," "," "," "," ",
"Kalopanax septemlobus"," "," ",
"Styphnolobium japonicum"," "," "," "," ",
"Betula nigra", " "," "," "," ",
"Pyrus ussuriensis"," "," "," "," ",
"Fagus engleriana"," "," "," ",
"Quercus rubra", " "," "," "," ",
"Aesculus flava"," "," "," "," ",
"Fagus grandifolia"," "," "," "," ",
"Pyrus calleryana var. dimorphophylla"," "," ")
axis(side=2,at=c(seq(from =2, to = 236, by = 2)),labels=(paste(rev(names))),las=1, cex.axis=0.3)
y<-rev(seq(from =2, to = 236, by = 2))
for(i in 1:length(inddat$Species)){
lines(c(inddat$LOutStart_DOY[i],inddat$LOutEnd_DOY[i]),c(y[i],y[i]), col="seagreen",lwd=2)
lines(c(inddat$LDStart_DOY[i],inddat$SenEnd_DOY[i]),c(y[i],y[i]), col="seagreen",lwd=2)
lines(c(inddat$FloStart_DOY[i],inddat$RipeFruEnd_DOY[i]),c(y[i]-0.4,y[i]-0.4),col="lightgray", lwd=2)
lines(c(inddat$FloStart_DOY[i],inddat$FruStart_DOY[i]),c(y[i]-0.4,y[i]-0.4), col="orchid", lwd=2)
lines(c(inddat$LDStart_DOY[i],inddat$LDEnd_DOY[i]),c(y[i],y[i]), col="palegreen", lwd=2)
lines(c(inddat$RipeFruStart_DOY[i],inddat$RipeFruEnd_DOY[i]),c(y[i]-0.4,y[i]-0.4), col="darkorchid", lwd=2)
lines(c(inddat$SenStart_DOY[i],inddat$SenEnd_DOY[i]),c(y[i],y[i]), col="yellow2",lwd=2)
}
legend(330,100, legend=c("budburst","leafout", "senescence","in flower","fruit developing", "ripe fruit"), lty=1,lwd=2,col=c("palegreen","seagreen","yellow","orchid","gray","darkorchid"))
quartz(height=12,width=12)#for pc you replace "quartz" with X11
par(mai=c(1,1.5,.1,.1), omi=c(1.5,.1,.1,.2))
plot(10,15, type="p", cex=.8,pch=21, col="white", bty="L", xlab="Day of Year",ylab=" ", ylim=c(2,236), yaxt='n',xlim=c(110,390),las=1)
#Make new label for y-axis that is has species name only once
names<- c("Populus deltoides"," "," "," "," ",
"Quercus alba"," "," "," "," " ,
"Quercus glandulifera"," "," "," ",
"Carya ovata"," "," "," "," ",
"Fraxinus chinensis"," "," "," "," ",
"Liquidambar styraciflua"," "," "," "," ",
"Platanus occidentalis","","","","",
"Carya glabra",""," "," "," ",
"Crataegus crus-galli"," "," "," "," ",
"Phellodendron amurense"," ","  "," ",
"Liriodendron tulipifera"," "," "," "," ",
"Betula alleghaniensis"," "," "," "," ",
"Gleditsia triacanthos"," "," "," "," ",
"Tilia japonica"," "," "," "," ",
"Catalpa speciosa"," "," "," "," ",
"Tilia americana"," "," "," "," ",
"Kalopanax septemlobus"," "," ",
"Styphnolobium japonicum"," "," "," "," ",
"Betula nigra", " "," "," "," ",
"Pyrus ussuriensis"," "," "," "," ",
"Fagus engleriana"," "," "," ",
"Quercus rubra", " "," "," "," ",
"Aesculus flava"," "," "," "," ",
"Fagus grandifolia"," "," "," "," ",
"Pyrus calleryana var. dimorphophylla"," "," ")
axis(side=2,at=c(seq(from =2, to = 236, by = 2)),labels=(paste(rev(names))),las=1, cex.axis=0.3, font=2)
quartz(height=12,width=12)#for pc you replace "quartz" with X11
par(mai=c(1,1.5,.1,.1), omi=c(1.5,.1,.1,.2))
plot(10,15, type="p", cex=.8,pch=21, col="white", bty="L", xlab="Day of Year",ylab=" ", ylim=c(2,236), yaxt='n',xlim=c(110,390),las=1)
#Make new label for y-axis that is has species name only once
names<- c("Populus deltoides"," "," "," "," ",
"Quercus alba"," "," "," "," " ,
"Quercus glandulifera"," "," "," ",
"Carya ovata"," "," "," "," ",
"Fraxinus chinensis"," "," "," "," ",
"Liquidambar styraciflua"," "," "," "," ",
"Platanus occidentalis","","","","",
"Carya glabra",""," "," "," ",
"Crataegus crus-galli"," "," "," "," ",
"Phellodendron amurense"," ","  "," ",
"Liriodendron tulipifera"," "," "," "," ",
"Betula alleghaniensis"," "," "," "," ",
"Gleditsia triacanthos"," "," "," "," ",
"Tilia japonica"," "," "," "," ",
"Catalpa speciosa"," "," "," "," ",
"Tilia americana"," "," "," "," ",
"Kalopanax septemlobus"," "," ",
"Styphnolobium japonicum"," "," "," "," ",
"Betula nigra", " "," "," "," ",
"Pyrus ussuriensis"," "," "," "," ",
"Fagus engleriana"," "," "," ",
"Quercus rubra", " "," "," "," ",
"Aesculus flava"," "," "," "," ",
"Fagus grandifolia"," "," "," "," ",
"Pyrus calleryana var. dimorphophylla"," "," ")
axis(side=2,at=c(seq(from =2, to = 236, by = 2)),labels=(paste(rev(names))),las=1, cex.axis=0.3, font=3, ticks=FALSE)
y<-rev(seq(from =2, to = 236, by = 2))
for(i in 1:length(inddat$Species)){
lines(c(inddat$LOutStart_DOY[i],inddat$LOutEnd_DOY[i]),c(y[i],y[i]), col="seagreen",lwd=2)
lines(c(inddat$LDStart_DOY[i],inddat$SenEnd_DOY[i]),c(y[i],y[i]), col="seagreen",lwd=2)
lines(c(inddat$FloStart_DOY[i],inddat$RipeFruEnd_DOY[i]),c(y[i]-0.4,y[i]-0.4),col="lightgray", lwd=2)
lines(c(inddat$FloStart_DOY[i],inddat$FruStart_DOY[i]),c(y[i]-0.4,y[i]-0.4), col="orchid", lwd=2)
lines(c(inddat$LDStart_DOY[i],inddat$LDEnd_DOY[i]),c(y[i],y[i]), col="palegreen", lwd=2)
lines(c(inddat$RipeFruStart_DOY[i],inddat$RipeFruEnd_DOY[i]),c(y[i]-0.4,y[i]-0.4), col="darkorchid", lwd=2)
lines(c(inddat$SenStart_DOY[i],inddat$SenEnd_DOY[i]),c(y[i],y[i]), col="yellow2",lwd=2)
}
legend(340,100, legend=c("budburst","leafout", "senescence","in flower","fruit developing", "ripe fruit"), lty=1,lwd=2,col=c("palegreen","seagreen","yellow","orchid","gray","darkorchid"))
quartz(height=12,width=12)#for pc you replace "quartz" with X11
par(mai=c(1,1.5,.1,.1), omi=c(1.5,.1,.1,.2))
plot(10,15, type="p", cex=.8,pch=21, col="white", bty="L", xlab="Day of Year",ylab=" ", ylim=c(2,236), yaxt='n',xlim=c(110,390),las=1)
#Make new label for y-axis that is has species name only once
names<- c("Populus deltoides"," "," "," "," ",
"Quercus alba"," "," "," "," " ,
"Quercus glandulifera"," "," "," ",
"Carya ovata"," "," "," "," ",
"Fraxinus chinensis"," "," "," "," ",
"Liquidambar styraciflua"," "," "," "," ",
"Platanus occidentalis","","","","",
"Carya glabra",""," "," "," ",
"Crataegus crus-galli"," "," "," "," ",
"Phellodendron amurense"," ","  "," ",
"Liriodendron tulipifera"," "," "," "," ",
"Betula alleghaniensis"," "," "," "," ",
"Gleditsia triacanthos"," "," "," "," ",
"Tilia japonica"," "," "," "," ",
"Catalpa speciosa"," "," "," "," ",
"Tilia americana"," "," "," "," ",
"Kalopanax septemlobus"," "," ",
"Styphnolobium japonicum"," "," "," "," ",
"Betula nigra", " "," "," "," ",
"Pyrus ussuriensis"," "," "," "," ",
"Fagus engleriana"," "," "," ",
"Quercus rubra", " "," "," "," ",
"Aesculus flava"," "," "," "," ",
"Fagus grandifolia"," "," "," "," ",
"Pyrus calleryana var. dimorphophylla"," "," ")
axis(side=2,at=c(seq(from =2, to = 236, by = 2)),labels=(paste(rev(names))),las=1, cex.axis=0.3, font=3, tick=FALSE)
y<-rev(seq(from =2, to = 236, by = 2))
for(i in 1:length(inddat$Species)){
lines(c(inddat$LOutStart_DOY[i],inddat$LOutEnd_DOY[i]),c(y[i],y[i]), col="seagreen",lwd=2)
lines(c(inddat$LDStart_DOY[i],inddat$SenEnd_DOY[i]),c(y[i],y[i]), col="seagreen",lwd=2)
lines(c(inddat$FloStart_DOY[i],inddat$RipeFruEnd_DOY[i]),c(y[i]-0.4,y[i]-0.4),col="lightgray", lwd=2)
lines(c(inddat$FloStart_DOY[i],inddat$FruStart_DOY[i]),c(y[i]-0.4,y[i]-0.4), col="orchid", lwd=2)
lines(c(inddat$LDStart_DOY[i],inddat$LDEnd_DOY[i]),c(y[i],y[i]), col="palegreen", lwd=2)
lines(c(inddat$RipeFruStart_DOY[i],inddat$RipeFruEnd_DOY[i]),c(y[i]-0.4,y[i]-0.4), col="darkorchid", lwd=2)
lines(c(inddat$SenStart_DOY[i],inddat$SenEnd_DOY[i]),c(y[i],y[i]), col="yellow2",lwd=2)
}
legend(340,100, legend=c("budburst","leafout", "senescence","in flower","fruit developing", "ripe fruit"), lty=1,lwd=2,col=c("palegreen","seagreen","yellow","orchid","gray","darkorchid"))
quartz(height=12,width=12)#for pc you replace "quartz" with X11
par(mai=c(1,1.5,.1,.1), omi=c(1.5,.1,.1,.2))
plot(10,15, type="p", cex=.8,pch=21, col="white", bty="L", xlab="Day of Year",ylab=" ", ylim=c(2,236), yaxt='n',xlim=c(110,390),las=1)
#Make new label for y-axis that is has species name only once
names<- c("Populus deltoides"," "," "," "," ",
"Quercus alba"," "," "," "," " ,
"Quercus glandulifera"," "," "," ",
"Carya ovata"," "," "," "," ",
"Fraxinus chinensis"," "," "," "," ",
"Liquidambar styraciflua"," "," "," "," ",
"Platanus occidentalis","","","","",
"Carya glabra",""," "," "," ",
"Crataegus crus-galli"," "," "," "," ",
"Phellodendron amurense"," ","  "," ",
"Liriodendron tulipifera"," "," "," "," ",
"Betula alleghaniensis"," "," "," "," ",
"Gleditsia triacanthos"," "," "," "," ",
"Tilia japonica"," "," "," "," ",
"Catalpa speciosa"," "," "," "," ",
"Tilia americana"," "," "," "," ",
"Kalopanax septemlobus"," "," ",
"Styphnolobium japonicum"," "," "," "," ",
"Betula nigra", " "," "," "," ",
"Pyrus ussuriensis"," "," "," "," ",
"Fagus engleriana"," "," "," ",
"Quercus rubra", " "," "," "," ",
"Aesculus flava"," "," "," "," ",
"Fagus grandifolia"," "," "," "," ",
"Pyrus calleryana var. dimorphophylla"," "," ")
axis(side=2,at=c(seq(from =2, to = 236, by = 2)),labels=(paste(rev(names))),las=1, cex.axis=0.5, font=3, tick=FALSE)
y<-rev(seq(from =2, to = 236, by = 2))
for(i in 1:length(inddat$Species)){
lines(c(inddat$LOutStart_DOY[i],inddat$LOutEnd_DOY[i]),c(y[i],y[i]), col="seagreen",lwd=2)
lines(c(inddat$LDStart_DOY[i],inddat$SenEnd_DOY[i]),c(y[i],y[i]), col="seagreen",lwd=2)
lines(c(inddat$FloStart_DOY[i],inddat$RipeFruEnd_DOY[i]),c(y[i]-0.4,y[i]-0.4),col="lightgray", lwd=2)
lines(c(inddat$FloStart_DOY[i],inddat$FruStart_DOY[i]),c(y[i]-0.4,y[i]-0.4), col="orchid", lwd=2)
lines(c(inddat$LDStart_DOY[i],inddat$LDEnd_DOY[i]),c(y[i],y[i]), col="palegreen", lwd=2)
lines(c(inddat$RipeFruStart_DOY[i],inddat$RipeFruEnd_DOY[i]),c(y[i]-0.4,y[i]-0.4), col="darkorchid", lwd=2)
lines(c(inddat$SenStart_DOY[i],inddat$SenEnd_DOY[i]),c(y[i],y[i]), col="yellow2",lwd=2)
}
legend(340,100, legend=c("budburst","leafout", "senescence","in flower","fruit developing", "ripe fruit"), lty=1,lwd=2,col=c("palegreen","seagreen","yellow","orchid","gray","darkorchid"))
quartz(height=12,width=12)#for pc you replace "quartz" with X11
par(mai=c(1,1.5,.1,.1), omi=c(1.5,.1,.1,.2))
plot(10,15, type="p", cex=.8,pch=21, col="white", bty="L", xlab="Day of Year",ylab=" ", ylim=c(2,236), yaxt='n',xlim=c(110,385),las=1)
#Make new label for y-axis that is has species name only once
names<- c("Populus deltoides"," "," "," "," ",
"Quercus alba"," "," "," "," " ,
"Quercus glandulifera"," "," "," ",
"Carya ovata"," "," "," "," ",
"Fraxinus chinensis"," "," "," "," ",
"Liquidambar styraciflua"," "," "," "," ",
"Platanus occidentalis","","","","",
"Carya glabra",""," "," "," ",
"Crataegus crus-galli"," "," "," "," ",
"Phellodendron amurense"," ","  "," ",
"Liriodendron tulipifera"," "," "," "," ",
"Betula alleghaniensis"," "," "," "," ",
"Gleditsia triacanthos"," "," "," "," ",
"Tilia japonica"," "," "," "," ",
"Catalpa speciosa"," "," "," "," ",
"Tilia americana"," "," "," "," ",
"Kalopanax septemlobus"," "," ",
"Styphnolobium japonicum"," "," "," "," ",
"Betula nigra", " "," "," "," ",
"Pyrus ussuriensis"," "," "," "," ",
"Fagus engleriana"," "," "," ",
"Quercus rubra", " "," "," "," ",
"Aesculus flava"," "," "," "," ",
"Fagus grandifolia"," "," "," "," ",
"Pyrus calleryana var. dimorphophylla"," "," ")
axis(side=2,at=c(seq(from =2, to = 236, by = 2)),labels=(paste(rev(names))),las=1, cex.axis=0.5, font=3, tick=FALSE)
y<-rev(seq(from =2, to = 236, by = 2))
for(i in 1:length(inddat$Species)){
lines(c(inddat$LOutStart_DOY[i],inddat$LOutEnd_DOY[i]),c(y[i],y[i]), col="seagreen",lwd=2)
lines(c(inddat$LDStart_DOY[i],inddat$SenEnd_DOY[i]),c(y[i],y[i]), col="seagreen",lwd=2)
lines(c(inddat$FloStart_DOY[i],inddat$RipeFruEnd_DOY[i]),c(y[i]-0.4,y[i]-0.4),col="lightgray", lwd=2)
lines(c(inddat$FloStart_DOY[i],inddat$FruStart_DOY[i]),c(y[i]-0.4,y[i]-0.4), col="orchid", lwd=2)
lines(c(inddat$LDStart_DOY[i],inddat$LDEnd_DOY[i]),c(y[i],y[i]), col="palegreen", lwd=2)
lines(c(inddat$RipeFruStart_DOY[i],inddat$RipeFruEnd_DOY[i]),c(y[i]-0.4,y[i]-0.4), col="darkorchid", lwd=2)
lines(c(inddat$SenStart_DOY[i],inddat$SenEnd_DOY[i]),c(y[i],y[i]), col="yellow2",lwd=2)
}
legend(340,50, legend=c("budburst","leafout", "senescence","in flower","fruit developing", "ripe fruit"), lty=1,lwd=2,col=c("palegreen","seagreen","yellow","orchid","gray","darkorchid"))
